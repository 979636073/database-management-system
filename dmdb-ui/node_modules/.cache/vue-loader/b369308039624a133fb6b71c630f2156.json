{"remainingRequest":"D:\\开发\\database-management-system\\dmdb-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\开发\\database-management-system\\dmdb-ui\\src\\components\\RoleDetail.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\开发\\database-management-system\\dmdb-ui\\src\\components\\RoleDetail.vue","mtime":1770395936529},{"path":"D:\\开发\\database-management-system\\dmdb-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\开发\\database-management-system\\dmdb-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\开发\\database-management-system\\dmdb-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\开发\\database-management-system\\dmdb-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgcmVxdWVzdCBmcm9tICdAL3V0aWxzL3JlcXVlc3QnOw0KDQpjb25zdCBDT1JFX1JPTEVTID0gWyJEQkEiLCAiUFVCTElDIiwgIlJFU09VUkNFIiwgIlNPSSIsICJTVkkiLCAiVlRJIl07DQoNCmNvbnN0IFNZU19QUklWUyA9IFsNCiAgICAiQ1JFQVRFIFRBQkxFIiwgIkNSRUFURSBWSUVXIiwgIkNSRUFURSBQUk9DRURVUkUiLCAiQ1JFQVRFIFRSSUdHRVIiLA0KICAgICJDUkVBVEUgU0VRVUVOQ0UiLCAiQ1JFQVRFIFNZTk9OWU0iLCANCiAgICAiQ1JFQVRFIFJPTEUiLCAiQ1JFQVRFIFVTRVIiLCAiRFJPUCBVU0VSIiwNCiAgICAiU0VMRUNUIEFOWSBUQUJMRSIsICJJTlNFUlQgQU5ZIFRBQkxFIiwgIlVQREFURSBBTlkgVEFCTEUiLCAiREVMRVRFIEFOWSBUQUJMRSINCl07DQoNCmNvbnN0IE9CSl9QUklWUyA9IFsiU0VMRUNUIiwgIklOU0VSVCIsICJVUERBVEUiLCAiREVMRVRFIiwgIkFMVEVSIiwgIklOREVYIiwgIlJFRkVSRU5DRVMiLCAiU0VMRUNUIEZPUiBEVU1QIl07DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgICBuYW1lOiAnUm9sZURldGFpbCcsDQogICAgcHJvcHM6IFsnY29ubklkJywgJ3JvbGVOYW1lJ10sDQogICAgZGF0YSgpIHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGxvYWRpbmc6IGZhbHNlLA0KICAgICAgICAgICAgYWN0aXZlVGFiOiAnZ2VuZXJhbCcsDQogICAgICAgICAgICBoZWFkZXJTdHlsZTogeyBiYWNrZ3JvdW5kOiAnI2Y1ZjdmYScsIGNvbG9yOiAnIzYwNjI2NicsIGZvbnRXZWlnaHQ6ICdib2xkJyB9LA0KDQogICAgICAgICAgICBnZW5lcmFsUm9sZXM6IENPUkVfUk9MRVMubWFwKHIgPT4gKHsgbmFtZTogciwgZ3JhbnRlZDogZmFsc2UsIGFkbWluOiBmYWxzZSwgX29yaWc6IHsgZ3JhbnRlZDogZmFsc2UsIGFkbWluOiBmYWxzZSB9IH0pKSwNCiAgICAgICAgICAgIHN5c1ByaXZMaXN0OiBTWVNfUFJJVlMubWFwKHAgPT4gKHsgbmFtZTogcCwgZ3JhbnRlZDogZmFsc2UsIGFkbWluOiBmYWxzZSwgX29yaWc6IHsgZ3JhbnRlZDogZmFsc2UsIGFkbWluOiBmYWxzZSB9IH0pKSwNCg0KICAgICAgICAgICAgc2NoZW1hTGlzdDogW10sIHNlbGVjdGVkU2NoZW1hOiAnJywgdGFibGVMaXN0OiBbXSwgdGFibGVGaWx0ZXI6ICcnLA0KICAgICAgICAgICAgY3VycmVudFRhYmxlOiAnJywNCiAgICAgICAgICAgIGN1cnJlbnRPYmpQZXJtczogT0JKX1BSSVZTLm1hcChwID0+ICh7IG5hbWU6IHAsIGdyYW50ZWQ6IGZhbHNlLCBhZG1pbjogZmFsc2UgfSkpLA0KICAgICAgICAgICAgZXhpc3RpbmdPYmpQcml2czogW10sDQoNCiAgICAgICAgICAgIHN5c0dyYW50QWxsOiBmYWxzZSwgc3lzQWRtaW5BbGw6IGZhbHNlLA0KICAgICAgICAgICAgb2JqR3JhbnRBbGw6IGZhbHNlLCBvYmpBZG1pbkFsbDogZmFsc2UsDQogICAgICAgIH07DQogICAgfSwNCiAgICBjb21wdXRlZDogew0KICAgICAgICBmaWx0ZXJlZFRhYmxlcygpIHsNCiAgICAgICAgICAgIGlmICghdGhpcy50YWJsZUZpbHRlcikgcmV0dXJuIHRoaXMudGFibGVMaXN0Ow0KICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFibGVMaXN0LmZpbHRlcih0ID0+IHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh0aGlzLnRhYmxlRmlsdGVyLnRvTG93ZXJDYXNlKCkpKTsNCiAgICAgICAgfSwNCiAgICAgICAgZmlsdGVyZWRFeGlzdGluZ09ialByaXZzKCkgew0KICAgICAgICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkU2NoZW1hKSByZXR1cm4gW107DQogICAgICAgICAgICByZXR1cm4gdGhpcy5leGlzdGluZ09ialByaXZzLmZpbHRlcihwID0+IHRoaXMuZ2V0TWFwVmFsdWUocCwgJ09XTkVSJykgPT09IHRoaXMuc2VsZWN0ZWRTY2hlbWEpOw0KICAgICAgICB9DQogICAgfSwNCiAgICBtb3VudGVkKCkgeyB0aGlzLnJlZnJlc2hEYXRhKCk7IH0sDQogICAgbWV0aG9kczogew0KICAgICAgICBhc3luYyByZXF1ZXN0KG1ldGhvZCwgdXJsLCBkYXRhID0ge30pIHsNCiAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IHsgbWV0aG9kLCB1cmw6ICcvZGInICsgdXJsLCBoZWFkZXJzOiB7ICdDb25uLUlkJzogdGhpcy5jb25uSWQgfSB9Ow0KICAgICAgICAgICAgaWYgKG1ldGhvZCA9PT0gJ2dldCcpIGNvbmZpZy5wYXJhbXMgPSBkYXRhOyBlbHNlIGNvbmZpZy5kYXRhID0gZGF0YTsNCiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0KGNvbmZpZyk7DQogICAgICAgIH0sDQogICAgICAgIGdldE1hcFZhbHVlKG9iaiwga2V5KSB7DQogICAgICAgICAgICBpZiAoIW9iaikgcmV0dXJuIG51bGw7DQogICAgICAgICAgICBpZiAob2JqW2tleV0gIT09IHVuZGVmaW5lZCkgcmV0dXJuIG9ialtrZXldOw0KICAgICAgICAgICAgaWYgKG9ialtrZXkudG9Mb3dlckNhc2UoKV0gIT09IHVuZGVmaW5lZCkgcmV0dXJuIG9ialtrZXkudG9Mb3dlckNhc2UoKV07DQogICAgICAgICAgICBpZiAob2JqW2tleS50b1VwcGVyQ2FzZSgpXSAhPT0gdW5kZWZpbmVkKSByZXR1cm4gb2JqW2tleS50b1VwcGVyQ2FzZSgpXTsNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICB9LA0KICAgICAgICBpc09wdGlvblRydWUodmFsKSB7DQogICAgICAgICAgICBpZiAoIXZhbCkgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgY29uc3QgcyA9IFN0cmluZyh2YWwpLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICByZXR1cm4gcyA9PT0gJ1lFUycgfHwgcyA9PT0gJ1knIHx8IHMgPT09ICdUUlVFJyB8fCBzID09PSAnMSc7DQogICAgICAgIH0sDQoNCiAgICAgICAgLy8gLS0tIOWFqOmAiemAu+i+kSAtLS0NCiAgICAgICAgaGFuZGxlU3lzR3JhbnRBbGxDaGFuZ2UodmFsKSB7DQogICAgICAgICAgICB0aGlzLnN5c1ByaXZMaXN0LmZvckVhY2goaXRlbSA9PiB7IGl0ZW0uZ3JhbnRlZCA9IHZhbDsgaWYgKCF2YWwpIGl0ZW0uYWRtaW4gPSBmYWxzZTsgfSk7DQogICAgICAgICAgICB0aGlzLnVwZGF0ZVN5c0FkbWluSGVhZGVyU3RhdGUoKTsNCiAgICAgICAgfSwNCiAgICAgICAgaGFuZGxlU3lzQWRtaW5BbGxDaGFuZ2UodmFsKSB7DQogICAgICAgICAgICB0aGlzLnN5c1ByaXZMaXN0LmZvckVhY2goaXRlbSA9PiB7IGl0ZW0uYWRtaW4gPSB2YWw7IGlmICh2YWwpIGl0ZW0uZ3JhbnRlZCA9IHRydWU7IH0pOw0KICAgICAgICAgICAgdGhpcy51cGRhdGVTeXNHcmFudEhlYWRlclN0YXRlKCk7DQogICAgICAgIH0sDQogICAgICAgIGhhbmRsZU9iakdyYW50QWxsQ2hhbmdlKHZhbCkgew0KICAgICAgICAgICAgdGhpcy5jdXJyZW50T2JqUGVybXMuZm9yRWFjaChpdGVtID0+IHsgaXRlbS5ncmFudGVkID0gdmFsOyBpZiAoIXZhbCkgaXRlbS5hZG1pbiA9IGZhbHNlOyB9KTsNCiAgICAgICAgICAgIHRoaXMudXBkYXRlT2JqQWRtaW5IZWFkZXJTdGF0ZSgpOw0KICAgICAgICB9LA0KICAgICAgICBoYW5kbGVPYmpBZG1pbkFsbENoYW5nZSh2YWwpIHsNCiAgICAgICAgICAgIHRoaXMuY3VycmVudE9ialBlcm1zLmZvckVhY2goaXRlbSA9PiB7IGl0ZW0uYWRtaW4gPSB2YWw7IGlmICh2YWwpIGl0ZW0uZ3JhbnRlZCA9IHRydWU7IH0pOw0KICAgICAgICAgICAgdGhpcy51cGRhdGVPYmpHcmFudEhlYWRlclN0YXRlKCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLy8gLS0tIOihjOeCueWHu+mAu+i+kSAtLS0NCiAgICAgICAgaGFuZGxlR3JhbnRDaGFuZ2Uocm93KSB7IGlmICghcm93LmdyYW50ZWQpIHJvdy5hZG1pbiA9IGZhbHNlOyB9LA0KICAgICAgICBoYW5kbGVBZG1pbkNoYW5nZShyb3cpIHsgaWYgKHJvdy5hZG1pbikgcm93LmdyYW50ZWQgPSB0cnVlOyB9LA0KDQogICAgICAgIGhhbmRsZVN5c1Jvd0NoYW5nZShyb3csIHR5cGUpIHsNCiAgICAgICAgICAgIGlmICh0eXBlID09PSAnZ3JhbnQnKSB0aGlzLmhhbmRsZUdyYW50Q2hhbmdlKHJvdyk7DQogICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2FkbWluJykgdGhpcy5oYW5kbGVBZG1pbkNoYW5nZShyb3cpOw0KICAgICAgICAgICAgdGhpcy51cGRhdGVTeXNHcmFudEhlYWRlclN0YXRlKCk7DQogICAgICAgICAgICB0aGlzLnVwZGF0ZVN5c0FkbWluSGVhZGVyU3RhdGUoKTsNCiAgICAgICAgfSwNCiAgICAgICAgaGFuZGxlT2JqUm93Q2hhbmdlKHJvdywgdHlwZSkgew0KICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdncmFudCcpIHRoaXMuaGFuZGxlR3JhbnRDaGFuZ2Uocm93KTsNCiAgICAgICAgICAgIGlmICh0eXBlID09PSAnYWRtaW4nKSB0aGlzLmhhbmRsZUFkbWluQ2hhbmdlKHJvdyk7DQogICAgICAgICAgICB0aGlzLnVwZGF0ZU9iakdyYW50SGVhZGVyU3RhdGUoKTsNCiAgICAgICAgICAgIHRoaXMudXBkYXRlT2JqQWRtaW5IZWFkZXJTdGF0ZSgpOw0KICAgICAgICB9LA0KDQogICAgICAgIHVwZGF0ZVN5c0dyYW50SGVhZGVyU3RhdGUoKSB7IHRoaXMuc3lzR3JhbnRBbGwgPSB0aGlzLnN5c1ByaXZMaXN0Lmxlbmd0aCA+IDAgJiYgdGhpcy5zeXNQcml2TGlzdC5ldmVyeShpID0+IGkuZ3JhbnRlZCk7IH0sDQogICAgICAgIHVwZGF0ZVN5c0FkbWluSGVhZGVyU3RhdGUoKSB7IHRoaXMuc3lzQWRtaW5BbGwgPSB0aGlzLnN5c1ByaXZMaXN0Lmxlbmd0aCA+IDAgJiYgdGhpcy5zeXNQcml2TGlzdC5ldmVyeShpID0+IGkuYWRtaW4pOyB9LA0KICAgICAgICB1cGRhdGVPYmpHcmFudEhlYWRlclN0YXRlKCkgeyB0aGlzLm9iakdyYW50QWxsID0gdGhpcy5jdXJyZW50T2JqUGVybXMubGVuZ3RoID4gMCAmJiB0aGlzLmN1cnJlbnRPYmpQZXJtcy5ldmVyeShpID0+IGkuZ3JhbnRlZCk7IH0sDQogICAgICAgIHVwZGF0ZU9iakFkbWluSGVhZGVyU3RhdGUoKSB7IHRoaXMub2JqQWRtaW5BbGwgPSB0aGlzLmN1cnJlbnRPYmpQZXJtcy5sZW5ndGggPiAwICYmIHRoaXMuY3VycmVudE9ialBlcm1zLmV2ZXJ5KGkgPT4gaS5hZG1pbik7IH0sDQoNCiAgICAgICAgLy8gLS0tIEFQSSDosIPnlKggLS0tDQogICAgICAgIHJlZnJlc2hEYXRhKCkgeyB0aGlzLmxvYWRpbmcgPSB0cnVlOyB0aGlzLmluaXREYXRhKCkuZmluYWxseSgoKSA9PiB7IHRoaXMubG9hZGluZyA9IGZhbHNlOyB9KTsgfSwNCiAgICAgICAgYXN5bmMgaW5pdERhdGEoKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIGNvbnN0IHNSZXMgPSBhd2FpdCB0aGlzLnJlcXVlc3QoJ2dldCcsICcvc2NoZW1hcycpOw0KICAgICAgICAgICAgICAgIHRoaXMuc2NoZW1hTGlzdCA9IHNSZXMuZGF0YS5kYXRhIHx8IFtdOw0KICAgICAgICAgICAgICAgIGlmICh0aGlzLnNjaGVtYUxpc3QuaW5jbHVkZXMoJ0RNREInKSkgdGhpcy5zZWxlY3RlZFNjaGVtYSA9ICdETURCJzsNCiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLnNjaGVtYUxpc3QubGVuZ3RoKSB0aGlzLnNlbGVjdGVkU2NoZW1hID0gdGhpcy5zY2hlbWFMaXN0WzBdOw0KICAgICAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKFt0aGlzLmxvYWRUYWJsZXMoKSwgdGhpcy5sb2FkUm9sZUluZm8oKV0pOw0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgeyB0aGlzLiRtZXNzYWdlLmVycm9yKCLliJ3lp4vljJblpLHotKU6ICIgKyBlLm1lc3NhZ2UpOyB9DQogICAgICAgIH0sDQogICAgICAgIGFzeW5jIGxvYWRSb2xlSW5mbygpIHsNCiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMucmVxdWVzdCgnZ2V0JywgJy9yb2xlL2RldGFpbCcsIHsgcm9sZU5hbWU6IHRoaXMucm9sZU5hbWUgfSk7DQogICAgICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PT0gMjAwKSB7DQogICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcy5kYXRhLmRhdGE7DQoNCiAgICAgICAgICAgICAgICBjb25zdCBkYlJvbGVzID0gZGF0YS5yb2xlUHJpdnMgfHwgW107DQogICAgICAgICAgICAgICAgdGhpcy5nZW5lcmFsUm9sZXMuZm9yRWFjaChyb3cgPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3VuZCA9IGRiUm9sZXMuZmluZChyID0+IHRoaXMuZ2V0TWFwVmFsdWUociwgJ0dSQU5URURfUk9MRScpID09PSByb3cubmFtZSk7DQogICAgICAgICAgICAgICAgICAgIHJvdy5ncmFudGVkID0gISFmb3VuZDsNCiAgICAgICAgICAgICAgICAgICAgcm93LmFkbWluID0gISEoZm91bmQgJiYgdGhpcy5pc09wdGlvblRydWUodGhpcy5nZXRNYXBWYWx1ZShmb3VuZCwgJ0FETUlOX09QVElPTicpKSk7DQogICAgICAgICAgICAgICAgICAgIHJvdy5fb3JpZyA9IHsgZ3JhbnRlZDogcm93LmdyYW50ZWQsIGFkbWluOiByb3cuYWRtaW4gfTsNCiAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgIGNvbnN0IGRiU3lzID0gZGF0YS5zeXNQcml2cyB8fCBbXTsNCiAgICAgICAgICAgICAgICB0aGlzLnN5c1ByaXZMaXN0LmZvckVhY2gocm93ID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm91bmQgPSBkYlN5cy5maW5kKHAgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcE5hbWUgPSB0aGlzLmdldE1hcFZhbHVlKHAsICdQUklWSUxFR0UnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTmFtZSAmJiBwTmFtZS50cmltKCkudG9VcHBlckNhc2UoKSA9PT0gcm93Lm5hbWUudHJpbSgpLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICByb3cuZ3JhbnRlZCA9ICEhZm91bmQ7DQogICAgICAgICAgICAgICAgICAgIHJvdy5hZG1pbiA9ICEhKGZvdW5kICYmIHRoaXMuaXNPcHRpb25UcnVlKHRoaXMuZ2V0TWFwVmFsdWUoZm91bmQsICdBRE1JTl9PUFRJT04nKSkpOw0KICAgICAgICAgICAgICAgICAgICByb3cuX29yaWcgPSB7IGdyYW50ZWQ6IHJvdy5ncmFudGVkLCBhZG1pbjogcm93LmFkbWluIH07DQogICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICB0aGlzLmV4aXN0aW5nT2JqUHJpdnMgPSBkYXRhLm9ialByaXZzIHx8IFtdOw0KICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsgdGhpcy51cGRhdGVTeXNHcmFudEhlYWRlclN0YXRlKCk7IHRoaXMudXBkYXRlU3lzQWRtaW5IZWFkZXJTdGF0ZSgpOyB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgYXN5bmMgbG9hZFRhYmxlcygpIHsNCiAgICAgICAgICAgIGlmICghdGhpcy5zZWxlY3RlZFNjaGVtYSkgcmV0dXJuOw0KICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5yZXF1ZXN0KCdnZXQnLCAnL3RhYmxlcycsIHsgc2NoZW1hOiB0aGlzLnNlbGVjdGVkU2NoZW1hIH0pOw0KICAgICAgICAgICAgdGhpcy50YWJsZUxpc3QgPSAocmVzLmRhdGEuZGF0YSB8fCBbXSkubWFwKHQgPT4gdC5UQUJMRV9OQU1FKTsNCiAgICAgICAgICAgIHRoaXMuY3VycmVudFRhYmxlID0gJyc7DQogICAgICAgIH0sDQogICAgICAgIGhhbmRsZVRhYmxlU2VsZWN0KHRhYmxlTmFtZSkgew0KICAgICAgICAgICAgdGhpcy5jdXJyZW50VGFibGUgPSB0YWJsZU5hbWU7DQogICAgICAgICAgICB0aGlzLmN1cnJlbnRPYmpQZXJtcyA9IE9CSl9QUklWUy5tYXAocE5hbWUgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IGZvdW5kID0gdGhpcy5leGlzdGluZ09ialByaXZzLmZpbmQocCA9Pg0KICAgICAgICAgICAgICAgICAgICB0aGlzLmdldE1hcFZhbHVlKHAsICdPV05FUicpID09PSB0aGlzLnNlbGVjdGVkU2NoZW1hICYmDQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0TWFwVmFsdWUocCwgJ1RBQkxFX05BTUUnKSA9PT0gdGFibGVOYW1lICYmDQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0TWFwVmFsdWUocCwgJ1BSSVZJTEVHRScpLnRvVXBwZXJDYXNlKCkgPT09IHBOYW1lLnRvVXBwZXJDYXNlKCkNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgIG5hbWU6IHBOYW1lLA0KICAgICAgICAgICAgICAgICAgICBncmFudGVkOiAhIWZvdW5kLA0KICAgICAgICAgICAgICAgICAgICBhZG1pbjogISEoZm91bmQgJiYgdGhpcy5pc09wdGlvblRydWUodGhpcy5nZXRNYXBWYWx1ZShmb3VuZCwgJ0dSQU5UQUJMRScpKSkNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7IHRoaXMudXBkYXRlT2JqR3JhbnRIZWFkZXJTdGF0ZSgpOyB0aGlzLnVwZGF0ZU9iakFkbWluSGVhZGVyU3RhdGUoKTsgfSk7DQogICAgICAgIH0sDQogICAgICAgIGdldENoYW5nZXMobGlzdCwga2V5TmFtZSkgew0KICAgICAgICAgICAgY29uc3QgY2hhbmdlcyA9IFtdOw0KICAgICAgICAgICAgbGlzdC5mb3JFYWNoKHJvdyA9PiB7DQogICAgICAgICAgICAgICAgaWYgKCFyb3cuX29yaWcgJiYga2V5TmFtZSAhPT0gJ3ByaXYnKSByZXR1cm47DQogICAgICAgICAgICAgICAgY29uc3Qgb3JpZ0dyYW50ZWQgPSByb3cuX29yaWcgPyByb3cuX29yaWcuZ3JhbnRlZCA6IGZhbHNlOw0KICAgICAgICAgICAgICAgIGNvbnN0IG9yaWdBZG1pbiA9IHJvdy5fb3JpZyA/IHJvdy5fb3JpZy5hZG1pbiA6IGZhbHNlOw0KICAgICAgICAgICAgICAgIGlmICghb3JpZ0dyYW50ZWQgJiYgcm93LmdyYW50ZWQpIGNoYW5nZXMucHVzaCh7IFtrZXlOYW1lXTogcm93Lm5hbWUsIGFjdGlvbjogJ0dSQU5UJywgYWRtaW46IHJvdy5hZG1pbiB9KTsNCiAgICAgICAgICAgICAgICBlbHNlIGlmIChvcmlnR3JhbnRlZCAmJiAhcm93LmdyYW50ZWQpIGNoYW5nZXMucHVzaCh7IFtrZXlOYW1lXTogcm93Lm5hbWUsIGFjdGlvbjogJ1JFVk9LRScsIGFkbWluOiBmYWxzZSB9KTsNCiAgICAgICAgICAgICAgICBlbHNlIGlmIChyb3cuZ3JhbnRlZCAmJiByb3cuYWRtaW4gIT09IG9yaWdBZG1pbikgY2hhbmdlcy5wdXNoKHsgW2tleU5hbWVdOiByb3cubmFtZSwgYWN0aW9uOiAnR1JBTlQnLCBhZG1pbjogcm93LmFkbWluIH0pOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICByZXR1cm4gY2hhbmdlczsNCiAgICAgICAgfSwNCiAgICAgICAgYXN5bmMgc2F2ZUdlbmVyYWwoKSB7DQogICAgICAgICAgICBjb25zdCBjaGFuZ2VzID0gdGhpcy5nZXRDaGFuZ2VzKHRoaXMuZ2VuZXJhbFJvbGVzLCAncm9sZScpOw0KICAgICAgICAgICAgaWYgKCFjaGFuZ2VzLmxlbmd0aCkgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuaW5mbygi5peg5Y+Y5pu0Iik7DQogICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgICAgICAgdHJ5IHsgYXdhaXQgdGhpcy5yZXF1ZXN0KCdwb3N0JywgJy9yb2xlL3JvbGUtcHJpdnMnLCB7IHJvbGVOYW1lOiB0aGlzLnJvbGVOYW1lLCBjaGFuZ2VzIH0pOyB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuS/neWtmOaIkOWKnyIpOyBhd2FpdCB0aGlzLmxvYWRSb2xlSW5mbygpOyB9IGNhdGNoIChlKSB7IHRoaXMuJG1lc3NhZ2UuZXJyb3IoZS5yZXNwb25zZT8uZGF0YT8ubXNnIHx8ICLkv53lrZjlpLHotKUiKTsgfSBmaW5hbGx5IHsgdGhpcy5sb2FkaW5nID0gZmFsc2U7IH0NCiAgICAgICAgfSwNCiAgICAgICAgYXN5bmMgc2F2ZVN5c1ByaXZzKCkgew0KICAgICAgICAgICAgY29uc3QgY2hhbmdlcyA9IHRoaXMuZ2V0Q2hhbmdlcyh0aGlzLnN5c1ByaXZMaXN0LCAncHJpdicpOw0KICAgICAgICAgICAgaWYgKCFjaGFuZ2VzLmxlbmd0aCkgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuaW5mbygi5peg5Y+Y5pu0Iik7DQogICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgICAgICAgdHJ5IHsgYXdhaXQgdGhpcy5yZXF1ZXN0KCdwb3N0JywgJy9yb2xlL3N5cy1wcml2cycsIHsgcm9sZU5hbWU6IHRoaXMucm9sZU5hbWUsIGNoYW5nZXMgfSk7IHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5L+d5a2Y5oiQ5YqfIik7IGF3YWl0IHRoaXMubG9hZFJvbGVJbmZvKCk7IH0gY2F0Y2ggKGUpIHsgdGhpcy4kbWVzc2FnZS5lcnJvcihlLnJlc3BvbnNlPy5kYXRhPy5tc2cgfHwgIuS/neWtmOWksei0pSIpOyB9IGZpbmFsbHkgeyB0aGlzLmxvYWRpbmcgPSBmYWxzZTsgfQ0KICAgICAgICB9LA0KICAgICAgICBhc3luYyBzYXZlT2JqUHJpdnMoKSB7DQogICAgICAgICAgICBpZiAoIXRoaXMuY3VycmVudFRhYmxlKSByZXR1cm47DQogICAgICAgICAgICBjb25zdCBjaGFuZ2VzID0gW107DQogICAgICAgICAgICB0aGlzLmN1cnJlbnRPYmpQZXJtcy5mb3JFYWNoKHJvdyA9PiB7DQogICAgICAgICAgICAgICAgY29uc3QgZm91bmQgPSB0aGlzLmV4aXN0aW5nT2JqUHJpdnMuZmluZChwID0+DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0TWFwVmFsdWUocCwgJ09XTkVSJykgPT09IHRoaXMuc2VsZWN0ZWRTY2hlbWEgJiYNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRNYXBWYWx1ZShwLCAnVEFCTEVfTkFNRScpID09PSB0aGlzLmN1cnJlbnRUYWJsZSAmJg0KICAgICAgICAgICAgICAgICAgICB0aGlzLmdldE1hcFZhbHVlKHAsICdQUklWSUxFR0UnKS50b1VwcGVyQ2FzZSgpID09PSByb3cubmFtZS50b1VwcGVyQ2FzZSgpDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvcmlnR3JhbnRlZCA9ICEhZm91bmQ7DQogICAgICAgICAgICAgICAgY29uc3Qgb3JpZ0FkbWluID0gISEoZm91bmQgJiYgdGhpcy5pc09wdGlvblRydWUodGhpcy5nZXRNYXBWYWx1ZShmb3VuZCwgJ0dSQU5UQUJMRScpKSk7DQogICAgICAgICAgICAgICAgaWYgKCFvcmlnR3JhbnRlZCAmJiByb3cuZ3JhbnRlZCkgY2hhbmdlcy5wdXNoKHsgcHJpdjogcm93Lm5hbWUsIGFjdGlvbjogJ0dSQU5UJywgYWRtaW46IHJvdy5hZG1pbiB9KTsNCiAgICAgICAgICAgICAgICBlbHNlIGlmIChvcmlnR3JhbnRlZCAmJiAhcm93LmdyYW50ZWQpIGNoYW5nZXMucHVzaCh7IHByaXY6IHJvdy5uYW1lLCBhY3Rpb246ICdSRVZPS0UnLCBhZG1pbjogZmFsc2UgfSk7DQogICAgICAgICAgICAgICAgZWxzZSBpZiAocm93LmdyYW50ZWQgJiYgcm93LmFkbWluICE9PSBvcmlnQWRtaW4pIGNoYW5nZXMucHVzaCh7IHByaXY6IHJvdy5uYW1lLCBhY3Rpb246ICdHUkFOVCcsIGFkbWluOiByb3cuYWRtaW4gfSk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGlmICghY2hhbmdlcy5sZW5ndGgpIHJldHVybiB0aGlzLiRtZXNzYWdlLmluZm8oIuaXoOWPmOabtCIpOw0KICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsNCiAgICAgICAgICAgIHRyeSB7IGF3YWl0IHRoaXMucmVxdWVzdCgncG9zdCcsICcvcm9sZS9vYmotcHJpdnMnLCB7IHJvbGVOYW1lOiB0aGlzLnJvbGVOYW1lLCBzY2hlbWE6IHRoaXMuc2VsZWN0ZWRTY2hlbWEsIHRhYmxlOiB0aGlzLmN1cnJlbnRUYWJsZSwgY2hhbmdlcyB9KTsgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLkv53lrZjmiJDlip8iKTsgYXdhaXQgdGhpcy5sb2FkUm9sZUluZm8oKTsgdGhpcy5oYW5kbGVUYWJsZVNlbGVjdCh0aGlzLmN1cnJlbnRUYWJsZSk7IH0gY2F0Y2ggKGUpIHsgdGhpcy4kbWVzc2FnZS5lcnJvcihlLnJlc3BvbnNlPy5kYXRhPy5tc2cgfHwgIuS/neWtmOWksei0pSIpOyB9IGZpbmFsbHkgeyB0aGlzLmxvYWRpbmcgPSBmYWxzZTsgfQ0KICAgICAgICB9DQogICAgfQ0KfQ0K"},{"version":3,"sources":["RoleDetail.vue"],"names":[],"mappings":";AA0MA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"RoleDetail.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div class=\"role-manage-container\" v-loading=\"loading\">\r\n\r\n        <div class=\"main-header\">\r\n            <div class=\"role-identity\">\r\n                <div class=\"avatar-box\">\r\n                    <i class=\"el-icon-user-solid\"></i>\r\n                </div>\r\n                <div class=\"info\">\r\n                    <div class=\"label\">当前管理角色</div>\r\n                    <div class=\"value\">{{ roleName }}</div>\r\n                </div>\r\n            </div>\r\n            <div class=\"actions\">\r\n                <el-button type=\"primary\" plain icon=\"el-icon-refresh\" size=\"small\"\r\n                    @click=\"refreshData\">刷新数据</el-button>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"main-content\">\r\n            <el-tabs v-model=\"activeTab\" type=\"border-card\" class=\"stylish-tabs\">\r\n\r\n                <el-tab-pane name=\"general\">\r\n                    <span slot=\"label\"><i class=\"el-icon-s-custom\"></i> 角色授予</span>\r\n                    <div class=\"pane-layout\">\r\n                        <div class=\"pane-toolbar\">\r\n                            <div class=\"toolbar-left\">\r\n                                <i class=\"el-icon-info text-info\"></i>\r\n                                <span class=\"tip-text\">将其他角色授予给当前角色 (继承权限)</span>\r\n                            </div>\r\n                            <el-button type=\"primary\" icon=\"el-icon-check\" size=\"small\"\r\n                                @click=\"saveGeneral\">保存配置</el-button>\r\n                        </div>\r\n\r\n                        <div class=\"table-wrapper\">\r\n                            <el-table :data=\"generalRoles\" border stripe height=\"100%\" size=\"medium\"\r\n                                :header-cell-style=\"headerStyle\">\r\n                                <el-table-column prop=\"name\" label=\"角色名称\">\r\n                                    <template slot-scope=\"scope\">\r\n                                        <el-tag size=\"medium\" effect=\"light\" class=\"priv-name-tag\">\r\n                                            <i class=\"el-icon-user\"></i> {{ scope.row.name }}\r\n                                        </el-tag>\r\n                                    </template>\r\n                                </el-table-column>\r\n                                <el-table-column label=\"授予 (Grant)\" align=\"center\" width=\"160\">\r\n                                    <template slot-scope=\"scope\">\r\n                                        <el-checkbox v-model=\"scope.row.granted\" @change=\"handleGrantChange(scope.row)\"\r\n                                            class=\"big-checkbox\"></el-checkbox>\r\n                                    </template>\r\n                                </el-table-column>\r\n                                <el-table-column label=\"允许转授 (With Admin)\" align=\"center\" width=\"200\">\r\n                                    <template slot-scope=\"scope\">\r\n                                        <el-checkbox v-model=\"scope.row.admin\" @change=\"handleAdminChange(scope.row)\"\r\n                                            class=\"big-checkbox\"></el-checkbox>\r\n                                    </template>\r\n                                </el-table-column>\r\n                            </el-table>\r\n                        </div>\r\n                    </div>\r\n                </el-tab-pane>\r\n\r\n                <el-tab-pane name=\"sysPrivs\">\r\n                    <span slot=\"label\"><i class=\"el-icon-setting\"></i> 系统权限</span>\r\n                    <div class=\"pane-layout\">\r\n                        <div class=\"pane-toolbar\">\r\n                            <div class=\"toolbar-left\">\r\n                                <i class=\"el-icon-warning-outline text-warning\"></i>\r\n                                <span class=\"tip-text\">配置全局系统操作权限 (如建表、建用户等)</span>\r\n                            </div>\r\n                            <el-button type=\"primary\" icon=\"el-icon-check\" size=\"small\"\r\n                                @click=\"saveSysPrivs\">保存配置</el-button>\r\n                        </div>\r\n\r\n                        <div class=\"table-wrapper\">\r\n                            <el-table :data=\"sysPrivList\" border stripe height=\"100%\" size=\"medium\"\r\n                                :header-cell-style=\"headerStyle\">\r\n                                <el-table-column prop=\"name\" label=\"权限名称\">\r\n                                    <template slot-scope=\"scope\">\r\n                                        <el-tag size=\"medium\" effect=\"light\" class=\"priv-name-tag\">{{ scope.row.name\r\n                                            }}</el-tag>\r\n                                    </template>\r\n                                </el-table-column>\r\n\r\n                                <el-table-column align=\"center\" width=\"180\">\r\n                                    <template slot=\"header\" slot-scope=\"scope\">\r\n                                        <el-checkbox v-model=\"sysGrantAll\" @change=\"handleSysGrantAllChange\"\r\n                                            class=\"header-checkbox\">授予 (Grant)</el-checkbox>\r\n                                    </template>\r\n                                    <template slot-scope=\"scope\">\r\n                                        <el-checkbox v-model=\"scope.row.granted\"\r\n                                            @change=\"handleSysRowChange(scope.row, 'grant')\"\r\n                                            class=\"big-checkbox\"></el-checkbox>\r\n                                    </template>\r\n                                </el-table-column>\r\n\r\n                                <el-table-column align=\"center\" width=\"220\">\r\n                                    <template slot=\"header\" slot-scope=\"scope\">\r\n                                        <el-checkbox v-model=\"sysAdminAll\" @change=\"handleSysAdminAllChange\"\r\n                                            class=\"header-checkbox\">转授 (With Admin)</el-checkbox>\r\n                                    </template>\r\n                                    <template slot-scope=\"scope\">\r\n                                        <el-checkbox v-model=\"scope.row.admin\"\r\n                                            @change=\"handleSysRowChange(scope.row, 'admin')\"\r\n                                            class=\"big-checkbox\"></el-checkbox>\r\n                                    </template>\r\n                                </el-table-column>\r\n                            </el-table>\r\n                        </div>\r\n                    </div>\r\n                </el-tab-pane>\r\n\r\n                <el-tab-pane name=\"objPrivs\">\r\n                    <span slot=\"label\"><i class=\"el-icon-document-copy\"></i> 对象权限</span>\r\n\r\n                    <div class=\"obj-layout\">\r\n                        <div class=\"obj-sidebar\">\r\n                            <div class=\"sidebar-search\">\r\n                                <el-select v-model=\"selectedSchema\" placeholder=\"选择模式\" size=\"small\" @change=\"loadTables\"\r\n                                    class=\"schema-select\">\r\n                                    <el-option v-for=\"s in schemaList\" :key=\"s\" :label=\"s\" :value=\"s\">\r\n                                        <span style=\"float: left; font-weight: bold\">{{ s }}</span>\r\n                                        <span style=\"float: right; color: #8492a6; font-size: 12px\"><i\r\n                                                class=\"el-icon-folder-opened\"></i></span>\r\n                                    </el-option>\r\n                                </el-select>\r\n                                <el-input placeholder=\"过滤表名...\" v-model=\"tableFilter\" size=\"small\" clearable\r\n                                    prefix-icon=\"el-icon-search\"></el-input>\r\n                            </div>\r\n\r\n                            <div class=\"sidebar-list custom-scroll\">\r\n                                <div v-for=\"t in filteredTables\" :key=\"t\" class=\"nav-item\"\r\n                                    :class=\"{ 'is-active': currentTable === t }\" @click=\"handleTableSelect(t)\">\r\n                                    <i class=\"el-icon-document\"></i>\r\n                                    <span class=\"nav-text\">{{ t }}</span>\r\n                                </div>\r\n                                <div v-if=\"filteredTables.length === 0\" class=\"empty-nav\">暂无数据</div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div class=\"obj-detail\">\r\n                            <div v-if=\"currentTable\" class=\"detail-inner\">\r\n                                <div class=\"pane-toolbar\">\r\n                                    <div class=\"toolbar-left\">\r\n                                        <span class=\"label\">当前对象：</span>\r\n                                        <el-tag type=\"success\" effect=\"dark\" size=\"medium\">{{ selectedSchema }} . {{\r\n                                            currentTable\r\n                                            }}</el-tag>\r\n                                    </div>\r\n                                    <el-button type=\"primary\" icon=\"el-icon-check\" size=\"small\"\r\n                                        @click=\"saveObjPrivs\">应用权限</el-button>\r\n                                </div>\r\n\r\n                                <div class=\"table-wrapper\">\r\n                                    <el-table :data=\"currentObjPerms\" border stripe height=\"100%\" size=\"medium\"\r\n                                        :header-cell-style=\"headerStyle\">\r\n                                        <el-table-column prop=\"name\" label=\"操作类型\">\r\n                                            <template slot-scope=\"scope\">\r\n                                                <el-tag size=\"medium\" effect=\"light\" class=\"priv-name-tag\">{{\r\n                                                    scope.row.name }}</el-tag>\r\n                                            </template>\r\n                                        </el-table-column>\r\n\r\n                                        <el-table-column align=\"center\" width=\"180\">\r\n                                            <template slot=\"header\" slot-scope=\"scope\">\r\n                                                <el-checkbox v-model=\"objGrantAll\" @change=\"handleObjGrantAllChange\"\r\n                                                    class=\"header-checkbox\">授予 (Grant)</el-checkbox>\r\n                                            </template>\r\n                                            <template slot-scope=\"scope\">\r\n                                                <el-checkbox v-model=\"scope.row.granted\"\r\n                                                    @change=\"handleObjRowChange(scope.row, 'grant')\"\r\n                                                    class=\"big-checkbox\"></el-checkbox>\r\n                                            </template>\r\n                                        </el-table-column>\r\n\r\n                                        <el-table-column align=\"center\" width=\"220\">\r\n                                            <template slot=\"header\" slot-scope=\"scope\">\r\n                                                <el-checkbox v-model=\"objAdminAll\" @change=\"handleObjAdminAllChange\"\r\n                                                    class=\"header-checkbox\">转授 (Grant Opt)</el-checkbox>\r\n                                            </template>\r\n                                            <template slot-scope=\"scope\">\r\n                                                <el-checkbox v-model=\"scope.row.admin\"\r\n                                                    @change=\"handleObjRowChange(scope.row, 'admin')\"\r\n                                                    class=\"big-checkbox\"></el-checkbox>\r\n                                            </template>\r\n                                        </el-table-column>\r\n                                    </el-table>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div v-else class=\"empty-state\">\r\n                                <i class=\"el-icon-mouse\"></i>\r\n                                <p>请在左侧列表点击选择一个数据表</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </el-tab-pane>\r\n            </el-tabs>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport request from '@/utils/request';\r\n\r\nconst CORE_ROLES = [\"DBA\", \"PUBLIC\", \"RESOURCE\", \"SOI\", \"SVI\", \"VTI\"];\r\n\r\nconst SYS_PRIVS = [\r\n    \"CREATE TABLE\", \"CREATE VIEW\", \"CREATE PROCEDURE\", \"CREATE TRIGGER\",\r\n    \"CREATE SEQUENCE\", \"CREATE SYNONYM\", \r\n    \"CREATE ROLE\", \"CREATE USER\", \"DROP USER\",\r\n    \"SELECT ANY TABLE\", \"INSERT ANY TABLE\", \"UPDATE ANY TABLE\", \"DELETE ANY TABLE\"\r\n];\r\n\r\nconst OBJ_PRIVS = [\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\", \"ALTER\", \"INDEX\", \"REFERENCES\", \"SELECT FOR DUMP\"];\r\n\r\nexport default {\r\n    name: 'RoleDetail',\r\n    props: ['connId', 'roleName'],\r\n    data() {\r\n        return {\r\n            loading: false,\r\n            activeTab: 'general',\r\n            headerStyle: { background: '#f5f7fa', color: '#606266', fontWeight: 'bold' },\r\n\r\n            generalRoles: CORE_ROLES.map(r => ({ name: r, granted: false, admin: false, _orig: { granted: false, admin: false } })),\r\n            sysPrivList: SYS_PRIVS.map(p => ({ name: p, granted: false, admin: false, _orig: { granted: false, admin: false } })),\r\n\r\n            schemaList: [], selectedSchema: '', tableList: [], tableFilter: '',\r\n            currentTable: '',\r\n            currentObjPerms: OBJ_PRIVS.map(p => ({ name: p, granted: false, admin: false })),\r\n            existingObjPrivs: [],\r\n\r\n            sysGrantAll: false, sysAdminAll: false,\r\n            objGrantAll: false, objAdminAll: false,\r\n        };\r\n    },\r\n    computed: {\r\n        filteredTables() {\r\n            if (!this.tableFilter) return this.tableList;\r\n            return this.tableList.filter(t => t.toLowerCase().includes(this.tableFilter.toLowerCase()));\r\n        },\r\n        filteredExistingObjPrivs() {\r\n            if (!this.selectedSchema) return [];\r\n            return this.existingObjPrivs.filter(p => this.getMapValue(p, 'OWNER') === this.selectedSchema);\r\n        }\r\n    },\r\n    mounted() { this.refreshData(); },\r\n    methods: {\r\n        async request(method, url, data = {}) {\r\n            const config = { method, url: '/db' + url, headers: { 'Conn-Id': this.connId } };\r\n            if (method === 'get') config.params = data; else config.data = data;\r\n            return request(config);\r\n        },\r\n        getMapValue(obj, key) {\r\n            if (!obj) return null;\r\n            if (obj[key] !== undefined) return obj[key];\r\n            if (obj[key.toLowerCase()] !== undefined) return obj[key.toLowerCase()];\r\n            if (obj[key.toUpperCase()] !== undefined) return obj[key.toUpperCase()];\r\n            return null;\r\n        },\r\n        isOptionTrue(val) {\r\n            if (!val) return false;\r\n            const s = String(val).toUpperCase();\r\n            return s === 'YES' || s === 'Y' || s === 'TRUE' || s === '1';\r\n        },\r\n\r\n        // --- 全选逻辑 ---\r\n        handleSysGrantAllChange(val) {\r\n            this.sysPrivList.forEach(item => { item.granted = val; if (!val) item.admin = false; });\r\n            this.updateSysAdminHeaderState();\r\n        },\r\n        handleSysAdminAllChange(val) {\r\n            this.sysPrivList.forEach(item => { item.admin = val; if (val) item.granted = true; });\r\n            this.updateSysGrantHeaderState();\r\n        },\r\n        handleObjGrantAllChange(val) {\r\n            this.currentObjPerms.forEach(item => { item.granted = val; if (!val) item.admin = false; });\r\n            this.updateObjAdminHeaderState();\r\n        },\r\n        handleObjAdminAllChange(val) {\r\n            this.currentObjPerms.forEach(item => { item.admin = val; if (val) item.granted = true; });\r\n            this.updateObjGrantHeaderState();\r\n        },\r\n\r\n        // --- 行点击逻辑 ---\r\n        handleGrantChange(row) { if (!row.granted) row.admin = false; },\r\n        handleAdminChange(row) { if (row.admin) row.granted = true; },\r\n\r\n        handleSysRowChange(row, type) {\r\n            if (type === 'grant') this.handleGrantChange(row);\r\n            if (type === 'admin') this.handleAdminChange(row);\r\n            this.updateSysGrantHeaderState();\r\n            this.updateSysAdminHeaderState();\r\n        },\r\n        handleObjRowChange(row, type) {\r\n            if (type === 'grant') this.handleGrantChange(row);\r\n            if (type === 'admin') this.handleAdminChange(row);\r\n            this.updateObjGrantHeaderState();\r\n            this.updateObjAdminHeaderState();\r\n        },\r\n\r\n        updateSysGrantHeaderState() { this.sysGrantAll = this.sysPrivList.length > 0 && this.sysPrivList.every(i => i.granted); },\r\n        updateSysAdminHeaderState() { this.sysAdminAll = this.sysPrivList.length > 0 && this.sysPrivList.every(i => i.admin); },\r\n        updateObjGrantHeaderState() { this.objGrantAll = this.currentObjPerms.length > 0 && this.currentObjPerms.every(i => i.granted); },\r\n        updateObjAdminHeaderState() { this.objAdminAll = this.currentObjPerms.length > 0 && this.currentObjPerms.every(i => i.admin); },\r\n\r\n        // --- API 调用 ---\r\n        refreshData() { this.loading = true; this.initData().finally(() => { this.loading = false; }); },\r\n        async initData() {\r\n            try {\r\n                const sRes = await this.request('get', '/schemas');\r\n                this.schemaList = sRes.data.data || [];\r\n                if (this.schemaList.includes('DMDB')) this.selectedSchema = 'DMDB';\r\n                else if (this.schemaList.length) this.selectedSchema = this.schemaList[0];\r\n                await Promise.all([this.loadTables(), this.loadRoleInfo()]);\r\n            } catch (e) { this.$message.error(\"初始化失败: \" + e.message); }\r\n        },\r\n        async loadRoleInfo() {\r\n            const res = await this.request('get', '/role/detail', { roleName: this.roleName });\r\n            if (res.data.code === 200) {\r\n                const data = res.data.data;\r\n\r\n                const dbRoles = data.rolePrivs || [];\r\n                this.generalRoles.forEach(row => {\r\n                    const found = dbRoles.find(r => this.getMapValue(r, 'GRANTED_ROLE') === row.name);\r\n                    row.granted = !!found;\r\n                    row.admin = !!(found && this.isOptionTrue(this.getMapValue(found, 'ADMIN_OPTION')));\r\n                    row._orig = { granted: row.granted, admin: row.admin };\r\n                });\r\n\r\n                const dbSys = data.sysPrivs || [];\r\n                this.sysPrivList.forEach(row => {\r\n                    const found = dbSys.find(p => {\r\n                        const pName = this.getMapValue(p, 'PRIVILEGE');\r\n                        return pName && pName.trim().toUpperCase() === row.name.trim().toUpperCase();\r\n                    });\r\n                    row.granted = !!found;\r\n                    row.admin = !!(found && this.isOptionTrue(this.getMapValue(found, 'ADMIN_OPTION')));\r\n                    row._orig = { granted: row.granted, admin: row.admin };\r\n                });\r\n\r\n                this.existingObjPrivs = data.objPrivs || [];\r\n                this.$nextTick(() => { this.updateSysGrantHeaderState(); this.updateSysAdminHeaderState(); });\r\n            }\r\n        },\r\n        async loadTables() {\r\n            if (!this.selectedSchema) return;\r\n            const res = await this.request('get', '/tables', { schema: this.selectedSchema });\r\n            this.tableList = (res.data.data || []).map(t => t.TABLE_NAME);\r\n            this.currentTable = '';\r\n        },\r\n        handleTableSelect(tableName) {\r\n            this.currentTable = tableName;\r\n            this.currentObjPerms = OBJ_PRIVS.map(pName => {\r\n                const found = this.existingObjPrivs.find(p =>\r\n                    this.getMapValue(p, 'OWNER') === this.selectedSchema &&\r\n                    this.getMapValue(p, 'TABLE_NAME') === tableName &&\r\n                    this.getMapValue(p, 'PRIVILEGE').toUpperCase() === pName.toUpperCase()\r\n                );\r\n                return {\r\n                    name: pName,\r\n                    granted: !!found,\r\n                    admin: !!(found && this.isOptionTrue(this.getMapValue(found, 'GRANTABLE')))\r\n                };\r\n            });\r\n            this.$nextTick(() => { this.updateObjGrantHeaderState(); this.updateObjAdminHeaderState(); });\r\n        },\r\n        getChanges(list, keyName) {\r\n            const changes = [];\r\n            list.forEach(row => {\r\n                if (!row._orig && keyName !== 'priv') return;\r\n                const origGranted = row._orig ? row._orig.granted : false;\r\n                const origAdmin = row._orig ? row._orig.admin : false;\r\n                if (!origGranted && row.granted) changes.push({ [keyName]: row.name, action: 'GRANT', admin: row.admin });\r\n                else if (origGranted && !row.granted) changes.push({ [keyName]: row.name, action: 'REVOKE', admin: false });\r\n                else if (row.granted && row.admin !== origAdmin) changes.push({ [keyName]: row.name, action: 'GRANT', admin: row.admin });\r\n            });\r\n            return changes;\r\n        },\r\n        async saveGeneral() {\r\n            const changes = this.getChanges(this.generalRoles, 'role');\r\n            if (!changes.length) return this.$message.info(\"无变更\");\r\n            this.loading = true;\r\n            try { await this.request('post', '/role/role-privs', { roleName: this.roleName, changes }); this.$message.success(\"保存成功\"); await this.loadRoleInfo(); } catch (e) { this.$message.error(e.response?.data?.msg || \"保存失败\"); } finally { this.loading = false; }\r\n        },\r\n        async saveSysPrivs() {\r\n            const changes = this.getChanges(this.sysPrivList, 'priv');\r\n            if (!changes.length) return this.$message.info(\"无变更\");\r\n            this.loading = true;\r\n            try { await this.request('post', '/role/sys-privs', { roleName: this.roleName, changes }); this.$message.success(\"保存成功\"); await this.loadRoleInfo(); } catch (e) { this.$message.error(e.response?.data?.msg || \"保存失败\"); } finally { this.loading = false; }\r\n        },\r\n        async saveObjPrivs() {\r\n            if (!this.currentTable) return;\r\n            const changes = [];\r\n            this.currentObjPerms.forEach(row => {\r\n                const found = this.existingObjPrivs.find(p =>\r\n                    this.getMapValue(p, 'OWNER') === this.selectedSchema &&\r\n                    this.getMapValue(p, 'TABLE_NAME') === this.currentTable &&\r\n                    this.getMapValue(p, 'PRIVILEGE').toUpperCase() === row.name.toUpperCase()\r\n                );\r\n                const origGranted = !!found;\r\n                const origAdmin = !!(found && this.isOptionTrue(this.getMapValue(found, 'GRANTABLE')));\r\n                if (!origGranted && row.granted) changes.push({ priv: row.name, action: 'GRANT', admin: row.admin });\r\n                else if (origGranted && !row.granted) changes.push({ priv: row.name, action: 'REVOKE', admin: false });\r\n                else if (row.granted && row.admin !== origAdmin) changes.push({ priv: row.name, action: 'GRANT', admin: row.admin });\r\n            });\r\n            if (!changes.length) return this.$message.info(\"无变更\");\r\n            this.loading = true;\r\n            try { await this.request('post', '/role/obj-privs', { roleName: this.roleName, schema: this.selectedSchema, table: this.currentTable, changes }); this.$message.success(\"保存成功\"); await this.loadRoleInfo(); this.handleTableSelect(this.currentTable); } catch (e) { this.$message.error(e.response?.data?.msg || \"保存失败\"); } finally { this.loading = false; }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* 全局容器 */\r\n.role-manage-container {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    background-color: #fff;\r\n    border-radius: 4px;\r\n    overflow: hidden;\r\n}\r\n\r\n/* 1. Header 样式 */\r\n.main-header {\r\n    height: 60px;\r\n    padding: 0 20px;\r\n    border-bottom: 1px solid #ebeef5;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    background: #fff;\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);\r\n    z-index: 10;\r\n}\r\n\r\n.role-identity {\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\n.avatar-box {\r\n    width: 36px;\r\n    height: 36px;\r\n    border-radius: 50%;\r\n    background: #ecf5ff;\r\n    color: #409EFF;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    font-size: 18px;\r\n    margin-right: 12px;\r\n    border: 1px solid #d9ecff;\r\n}\r\n\r\n.info .label {\r\n    font-size: 12px;\r\n    color: #909399;\r\n    line-height: 1.2;\r\n}\r\n\r\n.info .value {\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n    color: #303133;\r\n}\r\n\r\n/* 2. Tabs 样式 */\r\n.main-content {\r\n    flex: 1;\r\n    overflow: hidden;\r\n    padding: 15px 20px;\r\n}\r\n\r\n.stylish-tabs {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    box-shadow: none !important;\r\n    border: 1px solid #ebeef5;\r\n}\r\n\r\n::v-deep .el-tabs__content {\r\n    flex: 1;\r\n    height: 0;\r\n    padding: 0;\r\n    overflow: hidden;\r\n}\r\n\r\n::v-deep .el-tab-pane {\r\n    height: 100%;\r\n}\r\n\r\n/* 通用面板布局 */\r\n.pane-layout {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 15px;\r\n}\r\n\r\n.pane-toolbar {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-bottom: 12px;\r\n    background-color: #fcfcfc;\r\n    border: 1px solid #ebeef5;\r\n    padding: 8px 12px;\r\n    border-radius: 4px;\r\n}\r\n\r\n.toolbar-left {\r\n    font-size: 13px;\r\n    color: #606266;\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\n.text-info {\r\n    color: #909399;\r\n    margin-right: 6px;\r\n    font-size: 16px;\r\n}\r\n\r\n.text-warning {\r\n    color: #E6A23C;\r\n    margin-right: 6px;\r\n    font-size: 16px;\r\n}\r\n\r\n.table-wrapper {\r\n    flex: 1;\r\n    overflow: hidden;\r\n    border: 1px solid #ebeef5;\r\n    border-radius: 2px;\r\n}\r\n\r\n/* 3. 对象权限 双栏布局 */\r\n.obj-layout {\r\n    height: 100%;\r\n    display: flex;\r\n}\r\n\r\n/* 左侧导航 */\r\n.obj-sidebar {\r\n    width: 260px;\r\n    border-right: 1px solid #ebeef5;\r\n    background-color: #fdfdfd;\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n.sidebar-search {\r\n    padding: 12px;\r\n    border-bottom: 1px solid #ebeef5;\r\n    background: #fff;\r\n}\r\n\r\n.schema-select {\r\n    width: 100%;\r\n    margin-bottom: 8px;\r\n}\r\n\r\n.sidebar-list {\r\n    flex: 1;\r\n    overflow-y: auto;\r\n    padding: 8px 0;\r\n}\r\n\r\n.nav-item {\r\n    padding: 10px 15px;\r\n    cursor: pointer;\r\n    font-size: 13px;\r\n    color: #606266;\r\n    display: flex;\r\n    align-items: center;\r\n    border-left: 3px solid transparent;\r\n    transition: all 0.2s;\r\n}\r\n\r\n.nav-item i {\r\n    margin-right: 8px;\r\n    color: #909399;\r\n}\r\n\r\n.nav-item:hover {\r\n    background-color: #f5f7fa;\r\n    color: #409EFF;\r\n}\r\n\r\n.nav-item:hover i {\r\n    color: #409EFF;\r\n}\r\n\r\n.nav-item.is-active {\r\n    background-color: #ecf5ff;\r\n    color: #409EFF;\r\n    border-left-color: #409EFF;\r\n    font-weight: 500;\r\n}\r\n\r\n.nav-item.is-active i {\r\n    color: #409EFF;\r\n}\r\n\r\n.empty-nav {\r\n    text-align: center;\r\n    color: #909399;\r\n    margin-top: 20px;\r\n    font-size: 12px;\r\n}\r\n\r\n/* 右侧详情 */\r\n.obj-detail {\r\n    flex: 1;\r\n    background: #fff;\r\n    overflow: hidden;\r\n}\r\n\r\n.detail-inner {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 15px;\r\n}\r\n\r\n.label {\r\n    font-size: 13px;\r\n    color: #909399;\r\n    margin-right: 8px;\r\n}\r\n\r\n.empty-state {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: #c0c4cc;\r\n}\r\n\r\n.empty-state i {\r\n    font-size: 48px;\r\n    margin-bottom: 10px;\r\n    color: #e4e7ed;\r\n}\r\n\r\n/* 统一的绿色 Tag 样式 */\r\n.priv-name-tag {\r\n    background-color: #f0f9eb;\r\n    border-color: #e1f3d8;\r\n    color: #67c23a;\r\n    font-weight: 500;\r\n    border-radius: 4px;\r\n}\r\n\r\n/* 复选框微调 */\r\n::v-deep .el-checkbox__inner {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n::v-deep .el-checkbox__inner::after {\r\n    left: 5px;\r\n    top: 2px;\r\n}\r\n\r\n/* 自定义滚动条 */\r\n.custom-scroll::-webkit-scrollbar {\r\n    width: 6px;\r\n}\r\n\r\n.custom-scroll::-webkit-scrollbar-thumb {\r\n    background: #dcdfe6;\r\n    border-radius: 3px;\r\n}\r\n\r\n.custom-scroll::-webkit-scrollbar-track {\r\n    background: transparent;\r\n}\r\n</style>"]}]}
{"remainingRequest":"D:\\开发\\database-management-system\\dmdb-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\开发\\database-management-system\\dmdb-ui\\src\\components\\RoleDetail.vue?vue&type=style&index=0&id=2a0f39d2&scoped=true&lang=css","dependencies":[{"path":"D:\\开发\\database-management-system\\dmdb-ui\\src\\components\\RoleDetail.vue","mtime":1770395936529},{"path":"D:\\开发\\database-management-system\\dmdb-ui\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\开发\\database-management-system\\dmdb-ui\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\开发\\database-management-system\\dmdb-ui\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\开发\\database-management-system\\dmdb-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\开发\\database-management-system\\dmdb-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQovKiDlhajlsYDlrrnlmaggKi8NCi5yb2xlLW1hbmFnZS1jb250YWluZXIgew0KICAgIGhlaWdodDogMTAwJTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCn0NCg0KLyogMS4gSGVhZGVyIOagt+W8jyAqLw0KLm1haW4taGVhZGVyIHsNCiAgICBoZWlnaHQ6IDYwcHg7DQogICAgcGFkZGluZzogMCAyMHB4Ow0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWJlZWY1Ow0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYmFja2dyb3VuZDogI2ZmZjsNCiAgICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLCAwLCAwLCAwLjAyKTsNCiAgICB6LWluZGV4OiAxMDsNCn0NCg0KLnJvbGUtaWRlbnRpdHkgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCn0NCg0KLmF2YXRhci1ib3ggew0KICAgIHdpZHRoOiAzNnB4Ow0KICAgIGhlaWdodDogMzZweDsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgYmFja2dyb3VuZDogI2VjZjVmZjsNCiAgICBjb2xvcjogIzQwOUVGRjsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxOHB4Ow0KICAgIG1hcmdpbi1yaWdodDogMTJweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZDllY2ZmOw0KfQ0KDQouaW5mbyAubGFiZWwgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBjb2xvcjogIzkwOTM5OTsNCiAgICBsaW5lLWhlaWdodDogMS4yOw0KfQ0KDQouaW5mbyAudmFsdWUgew0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiAjMzAzMTMzOw0KfQ0KDQovKiAyLiBUYWJzIOagt+W8jyAqLw0KLm1haW4tY29udGVudCB7DQogICAgZmxleDogMTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIHBhZGRpbmc6IDE1cHggMjBweDsNCn0NCg0KLnN0eWxpc2gtdGFicyB7DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBib3gtc2hhZG93OiBub25lICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyOiAxcHggc29saWQgI2ViZWVmNTsNCn0NCg0KOjp2LWRlZXAgLmVsLXRhYnNfX2NvbnRlbnQgew0KICAgIGZsZXg6IDE7DQogICAgaGVpZ2h0OiAwOw0KICAgIHBhZGRpbmc6IDA7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCn0NCg0KOjp2LWRlZXAgLmVsLXRhYi1wYW5lIHsNCiAgICBoZWlnaHQ6IDEwMCU7DQp9DQoNCi8qIOmAmueUqOmdouadv+W4g+WxgCAqLw0KLnBhbmUtbGF5b3V0IHsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIHBhZGRpbmc6IDE1cHg7DQp9DQoNCi5wYW5lLXRvb2xiYXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgbWFyZ2luLWJvdHRvbTogMTJweDsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmNmY2ZjOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkICNlYmVlZjU7DQogICAgcGFkZGluZzogOHB4IDEycHg7DQogICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KDQoudG9vbGJhci1sZWZ0IHsNCiAgICBmb250LXNpemU6IDEzcHg7DQogICAgY29sb3I6ICM2MDYyNjY7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KfQ0KDQoudGV4dC1pbmZvIHsNCiAgICBjb2xvcjogIzkwOTM5OTsNCiAgICBtYXJnaW4tcmlnaHQ6IDZweDsNCiAgICBmb250LXNpemU6IDE2cHg7DQp9DQoNCi50ZXh0LXdhcm5pbmcgew0KICAgIGNvbG9yOiAjRTZBMjNDOw0KICAgIG1hcmdpbi1yaWdodDogNnB4Ow0KICAgIGZvbnQtc2l6ZTogMTZweDsNCn0NCg0KLnRhYmxlLXdyYXBwZXIgew0KICAgIGZsZXg6IDE7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZWJlZWY1Ow0KICAgIGJvcmRlci1yYWRpdXM6IDJweDsNCn0NCg0KLyogMy4g5a+56LGh5p2D6ZmQIOWPjOagj+W4g+WxgCAqLw0KLm9iai1sYXlvdXQgew0KICAgIGhlaWdodDogMTAwJTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KfQ0KDQovKiDlt6bkvqflr7zoiKogKi8NCi5vYmotc2lkZWJhciB7DQogICAgd2lkdGg6IDI2MHB4Ow0KICAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICNlYmVlZjU7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZkZmRmZDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQp9DQoNCi5zaWRlYmFyLXNlYXJjaCB7DQogICAgcGFkZGluZzogMTJweDsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2ViZWVmNTsNCiAgICBiYWNrZ3JvdW5kOiAjZmZmOw0KfQ0KDQouc2NoZW1hLXNlbGVjdCB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgbWFyZ2luLWJvdHRvbTogOHB4Ow0KfQ0KDQouc2lkZWJhci1saXN0IHsNCiAgICBmbGV4OiAxOw0KICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgcGFkZGluZzogOHB4IDA7DQp9DQoNCi5uYXYtaXRlbSB7DQogICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICBmb250LXNpemU6IDEzcHg7DQogICAgY29sb3I6ICM2MDYyNjY7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGJvcmRlci1sZWZ0OiAzcHggc29saWQgdHJhbnNwYXJlbnQ7DQogICAgdHJhbnNpdGlvbjogYWxsIDAuMnM7DQp9DQoNCi5uYXYtaXRlbSBpIHsNCiAgICBtYXJnaW4tcmlnaHQ6IDhweDsNCiAgICBjb2xvcjogIzkwOTM5OTsNCn0NCg0KLm5hdi1pdGVtOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjVmN2ZhOw0KICAgIGNvbG9yOiAjNDA5RUZGOw0KfQ0KDQoubmF2LWl0ZW06aG92ZXIgaSB7DQogICAgY29sb3I6ICM0MDlFRkY7DQp9DQoNCi5uYXYtaXRlbS5pcy1hY3RpdmUgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNlY2Y1ZmY7DQogICAgY29sb3I6ICM0MDlFRkY7DQogICAgYm9yZGVyLWxlZnQtY29sb3I6ICM0MDlFRkY7DQogICAgZm9udC13ZWlnaHQ6IDUwMDsNCn0NCg0KLm5hdi1pdGVtLmlzLWFjdGl2ZSBpIHsNCiAgICBjb2xvcjogIzQwOUVGRjsNCn0NCg0KLmVtcHR5LW5hdiB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGNvbG9yOiAjOTA5Mzk5Ow0KICAgIG1hcmdpbi10b3A6IDIwcHg7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KfQ0KDQovKiDlj7Pkvqfor6bmg4UgKi8NCi5vYmotZGV0YWlsIHsNCiAgICBmbGV4OiAxOw0KICAgIGJhY2tncm91bmQ6ICNmZmY7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCn0NCg0KLmRldGFpbC1pbm5lciB7DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBwYWRkaW5nOiAxNXB4Ow0KfQ0KDQoubGFiZWwgew0KICAgIGZvbnQtc2l6ZTogMTNweDsNCiAgICBjb2xvcjogIzkwOTM5OTsNCiAgICBtYXJnaW4tcmlnaHQ6IDhweDsNCn0NCg0KLmVtcHR5LXN0YXRlIHsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgY29sb3I6ICNjMGM0Y2M7DQp9DQoNCi5lbXB0eS1zdGF0ZSBpIHsNCiAgICBmb250LXNpemU6IDQ4cHg7DQogICAgbWFyZ2luLWJvdHRvbTogMTBweDsNCiAgICBjb2xvcjogI2U0ZTdlZDsNCn0NCg0KLyog57uf5LiA55qE57u/6ImyIFRhZyDmoLflvI8gKi8NCi5wcml2LW5hbWUtdGFnIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjBmOWViOw0KICAgIGJvcmRlci1jb2xvcjogI2UxZjNkODsNCiAgICBjb2xvcjogIzY3YzIzYTsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCn0NCg0KLyog5aSN6YCJ5qGG5b6u6LCDICovDQo6OnYtZGVlcCAuZWwtY2hlY2tib3hfX2lubmVyIHsNCiAgICB3aWR0aDogMTZweDsNCiAgICBoZWlnaHQ6IDE2cHg7DQp9DQoNCjo6di1kZWVwIC5lbC1jaGVja2JveF9faW5uZXI6OmFmdGVyIHsNCiAgICBsZWZ0OiA1cHg7DQogICAgdG9wOiAycHg7DQp9DQoNCi8qIOiHquWumuS5iea7muWKqOadoSAqLw0KLmN1c3RvbS1zY3JvbGw6Oi13ZWJraXQtc2Nyb2xsYmFyIHsNCiAgICB3aWR0aDogNnB4Ow0KfQ0KDQouY3VzdG9tLXNjcm9sbDo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIgew0KICAgIGJhY2tncm91bmQ6ICNkY2RmZTY7DQogICAgYm9yZGVyLXJhZGl1czogM3B4Ow0KfQ0KDQouY3VzdG9tLXNjcm9sbDo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2sgew0KICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50Ow0KfQ0K"},{"version":3,"sources":["RoleDetail.vue"],"names":[],"mappings":";AA+ZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"RoleDetail.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div class=\"role-manage-container\" v-loading=\"loading\">\r\n\r\n        <div class=\"main-header\">\r\n            <div class=\"role-identity\">\r\n                <div class=\"avatar-box\">\r\n                    <i class=\"el-icon-user-solid\"></i>\r\n                </div>\r\n                <div class=\"info\">\r\n                    <div class=\"label\">当前管理角色</div>\r\n                    <div class=\"value\">{{ roleName }}</div>\r\n                </div>\r\n            </div>\r\n            <div class=\"actions\">\r\n                <el-button type=\"primary\" plain icon=\"el-icon-refresh\" size=\"small\"\r\n                    @click=\"refreshData\">刷新数据</el-button>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"main-content\">\r\n            <el-tabs v-model=\"activeTab\" type=\"border-card\" class=\"stylish-tabs\">\r\n\r\n                <el-tab-pane name=\"general\">\r\n                    <span slot=\"label\"><i class=\"el-icon-s-custom\"></i> 角色授予</span>\r\n                    <div class=\"pane-layout\">\r\n                        <div class=\"pane-toolbar\">\r\n                            <div class=\"toolbar-left\">\r\n                                <i class=\"el-icon-info text-info\"></i>\r\n                                <span class=\"tip-text\">将其他角色授予给当前角色 (继承权限)</span>\r\n                            </div>\r\n                            <el-button type=\"primary\" icon=\"el-icon-check\" size=\"small\"\r\n                                @click=\"saveGeneral\">保存配置</el-button>\r\n                        </div>\r\n\r\n                        <div class=\"table-wrapper\">\r\n                            <el-table :data=\"generalRoles\" border stripe height=\"100%\" size=\"medium\"\r\n                                :header-cell-style=\"headerStyle\">\r\n                                <el-table-column prop=\"name\" label=\"角色名称\">\r\n                                    <template slot-scope=\"scope\">\r\n                                        <el-tag size=\"medium\" effect=\"light\" class=\"priv-name-tag\">\r\n                                            <i class=\"el-icon-user\"></i> {{ scope.row.name }}\r\n                                        </el-tag>\r\n                                    </template>\r\n                                </el-table-column>\r\n                                <el-table-column label=\"授予 (Grant)\" align=\"center\" width=\"160\">\r\n                                    <template slot-scope=\"scope\">\r\n                                        <el-checkbox v-model=\"scope.row.granted\" @change=\"handleGrantChange(scope.row)\"\r\n                                            class=\"big-checkbox\"></el-checkbox>\r\n                                    </template>\r\n                                </el-table-column>\r\n                                <el-table-column label=\"允许转授 (With Admin)\" align=\"center\" width=\"200\">\r\n                                    <template slot-scope=\"scope\">\r\n                                        <el-checkbox v-model=\"scope.row.admin\" @change=\"handleAdminChange(scope.row)\"\r\n                                            class=\"big-checkbox\"></el-checkbox>\r\n                                    </template>\r\n                                </el-table-column>\r\n                            </el-table>\r\n                        </div>\r\n                    </div>\r\n                </el-tab-pane>\r\n\r\n                <el-tab-pane name=\"sysPrivs\">\r\n                    <span slot=\"label\"><i class=\"el-icon-setting\"></i> 系统权限</span>\r\n                    <div class=\"pane-layout\">\r\n                        <div class=\"pane-toolbar\">\r\n                            <div class=\"toolbar-left\">\r\n                                <i class=\"el-icon-warning-outline text-warning\"></i>\r\n                                <span class=\"tip-text\">配置全局系统操作权限 (如建表、建用户等)</span>\r\n                            </div>\r\n                            <el-button type=\"primary\" icon=\"el-icon-check\" size=\"small\"\r\n                                @click=\"saveSysPrivs\">保存配置</el-button>\r\n                        </div>\r\n\r\n                        <div class=\"table-wrapper\">\r\n                            <el-table :data=\"sysPrivList\" border stripe height=\"100%\" size=\"medium\"\r\n                                :header-cell-style=\"headerStyle\">\r\n                                <el-table-column prop=\"name\" label=\"权限名称\">\r\n                                    <template slot-scope=\"scope\">\r\n                                        <el-tag size=\"medium\" effect=\"light\" class=\"priv-name-tag\">{{ scope.row.name\r\n                                            }}</el-tag>\r\n                                    </template>\r\n                                </el-table-column>\r\n\r\n                                <el-table-column align=\"center\" width=\"180\">\r\n                                    <template slot=\"header\" slot-scope=\"scope\">\r\n                                        <el-checkbox v-model=\"sysGrantAll\" @change=\"handleSysGrantAllChange\"\r\n                                            class=\"header-checkbox\">授予 (Grant)</el-checkbox>\r\n                                    </template>\r\n                                    <template slot-scope=\"scope\">\r\n                                        <el-checkbox v-model=\"scope.row.granted\"\r\n                                            @change=\"handleSysRowChange(scope.row, 'grant')\"\r\n                                            class=\"big-checkbox\"></el-checkbox>\r\n                                    </template>\r\n                                </el-table-column>\r\n\r\n                                <el-table-column align=\"center\" width=\"220\">\r\n                                    <template slot=\"header\" slot-scope=\"scope\">\r\n                                        <el-checkbox v-model=\"sysAdminAll\" @change=\"handleSysAdminAllChange\"\r\n                                            class=\"header-checkbox\">转授 (With Admin)</el-checkbox>\r\n                                    </template>\r\n                                    <template slot-scope=\"scope\">\r\n                                        <el-checkbox v-model=\"scope.row.admin\"\r\n                                            @change=\"handleSysRowChange(scope.row, 'admin')\"\r\n                                            class=\"big-checkbox\"></el-checkbox>\r\n                                    </template>\r\n                                </el-table-column>\r\n                            </el-table>\r\n                        </div>\r\n                    </div>\r\n                </el-tab-pane>\r\n\r\n                <el-tab-pane name=\"objPrivs\">\r\n                    <span slot=\"label\"><i class=\"el-icon-document-copy\"></i> 对象权限</span>\r\n\r\n                    <div class=\"obj-layout\">\r\n                        <div class=\"obj-sidebar\">\r\n                            <div class=\"sidebar-search\">\r\n                                <el-select v-model=\"selectedSchema\" placeholder=\"选择模式\" size=\"small\" @change=\"loadTables\"\r\n                                    class=\"schema-select\">\r\n                                    <el-option v-for=\"s in schemaList\" :key=\"s\" :label=\"s\" :value=\"s\">\r\n                                        <span style=\"float: left; font-weight: bold\">{{ s }}</span>\r\n                                        <span style=\"float: right; color: #8492a6; font-size: 12px\"><i\r\n                                                class=\"el-icon-folder-opened\"></i></span>\r\n                                    </el-option>\r\n                                </el-select>\r\n                                <el-input placeholder=\"过滤表名...\" v-model=\"tableFilter\" size=\"small\" clearable\r\n                                    prefix-icon=\"el-icon-search\"></el-input>\r\n                            </div>\r\n\r\n                            <div class=\"sidebar-list custom-scroll\">\r\n                                <div v-for=\"t in filteredTables\" :key=\"t\" class=\"nav-item\"\r\n                                    :class=\"{ 'is-active': currentTable === t }\" @click=\"handleTableSelect(t)\">\r\n                                    <i class=\"el-icon-document\"></i>\r\n                                    <span class=\"nav-text\">{{ t }}</span>\r\n                                </div>\r\n                                <div v-if=\"filteredTables.length === 0\" class=\"empty-nav\">暂无数据</div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div class=\"obj-detail\">\r\n                            <div v-if=\"currentTable\" class=\"detail-inner\">\r\n                                <div class=\"pane-toolbar\">\r\n                                    <div class=\"toolbar-left\">\r\n                                        <span class=\"label\">当前对象：</span>\r\n                                        <el-tag type=\"success\" effect=\"dark\" size=\"medium\">{{ selectedSchema }} . {{\r\n                                            currentTable\r\n                                            }}</el-tag>\r\n                                    </div>\r\n                                    <el-button type=\"primary\" icon=\"el-icon-check\" size=\"small\"\r\n                                        @click=\"saveObjPrivs\">应用权限</el-button>\r\n                                </div>\r\n\r\n                                <div class=\"table-wrapper\">\r\n                                    <el-table :data=\"currentObjPerms\" border stripe height=\"100%\" size=\"medium\"\r\n                                        :header-cell-style=\"headerStyle\">\r\n                                        <el-table-column prop=\"name\" label=\"操作类型\">\r\n                                            <template slot-scope=\"scope\">\r\n                                                <el-tag size=\"medium\" effect=\"light\" class=\"priv-name-tag\">{{\r\n                                                    scope.row.name }}</el-tag>\r\n                                            </template>\r\n                                        </el-table-column>\r\n\r\n                                        <el-table-column align=\"center\" width=\"180\">\r\n                                            <template slot=\"header\" slot-scope=\"scope\">\r\n                                                <el-checkbox v-model=\"objGrantAll\" @change=\"handleObjGrantAllChange\"\r\n                                                    class=\"header-checkbox\">授予 (Grant)</el-checkbox>\r\n                                            </template>\r\n                                            <template slot-scope=\"scope\">\r\n                                                <el-checkbox v-model=\"scope.row.granted\"\r\n                                                    @change=\"handleObjRowChange(scope.row, 'grant')\"\r\n                                                    class=\"big-checkbox\"></el-checkbox>\r\n                                            </template>\r\n                                        </el-table-column>\r\n\r\n                                        <el-table-column align=\"center\" width=\"220\">\r\n                                            <template slot=\"header\" slot-scope=\"scope\">\r\n                                                <el-checkbox v-model=\"objAdminAll\" @change=\"handleObjAdminAllChange\"\r\n                                                    class=\"header-checkbox\">转授 (Grant Opt)</el-checkbox>\r\n                                            </template>\r\n                                            <template slot-scope=\"scope\">\r\n                                                <el-checkbox v-model=\"scope.row.admin\"\r\n                                                    @change=\"handleObjRowChange(scope.row, 'admin')\"\r\n                                                    class=\"big-checkbox\"></el-checkbox>\r\n                                            </template>\r\n                                        </el-table-column>\r\n                                    </el-table>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div v-else class=\"empty-state\">\r\n                                <i class=\"el-icon-mouse\"></i>\r\n                                <p>请在左侧列表点击选择一个数据表</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </el-tab-pane>\r\n            </el-tabs>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport request from '@/utils/request';\r\n\r\nconst CORE_ROLES = [\"DBA\", \"PUBLIC\", \"RESOURCE\", \"SOI\", \"SVI\", \"VTI\"];\r\n\r\nconst SYS_PRIVS = [\r\n    \"CREATE TABLE\", \"CREATE VIEW\", \"CREATE PROCEDURE\", \"CREATE TRIGGER\",\r\n    \"CREATE SEQUENCE\", \"CREATE SYNONYM\", \r\n    \"CREATE ROLE\", \"CREATE USER\", \"DROP USER\",\r\n    \"SELECT ANY TABLE\", \"INSERT ANY TABLE\", \"UPDATE ANY TABLE\", \"DELETE ANY TABLE\"\r\n];\r\n\r\nconst OBJ_PRIVS = [\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\", \"ALTER\", \"INDEX\", \"REFERENCES\", \"SELECT FOR DUMP\"];\r\n\r\nexport default {\r\n    name: 'RoleDetail',\r\n    props: ['connId', 'roleName'],\r\n    data() {\r\n        return {\r\n            loading: false,\r\n            activeTab: 'general',\r\n            headerStyle: { background: '#f5f7fa', color: '#606266', fontWeight: 'bold' },\r\n\r\n            generalRoles: CORE_ROLES.map(r => ({ name: r, granted: false, admin: false, _orig: { granted: false, admin: false } })),\r\n            sysPrivList: SYS_PRIVS.map(p => ({ name: p, granted: false, admin: false, _orig: { granted: false, admin: false } })),\r\n\r\n            schemaList: [], selectedSchema: '', tableList: [], tableFilter: '',\r\n            currentTable: '',\r\n            currentObjPerms: OBJ_PRIVS.map(p => ({ name: p, granted: false, admin: false })),\r\n            existingObjPrivs: [],\r\n\r\n            sysGrantAll: false, sysAdminAll: false,\r\n            objGrantAll: false, objAdminAll: false,\r\n        };\r\n    },\r\n    computed: {\r\n        filteredTables() {\r\n            if (!this.tableFilter) return this.tableList;\r\n            return this.tableList.filter(t => t.toLowerCase().includes(this.tableFilter.toLowerCase()));\r\n        },\r\n        filteredExistingObjPrivs() {\r\n            if (!this.selectedSchema) return [];\r\n            return this.existingObjPrivs.filter(p => this.getMapValue(p, 'OWNER') === this.selectedSchema);\r\n        }\r\n    },\r\n    mounted() { this.refreshData(); },\r\n    methods: {\r\n        async request(method, url, data = {}) {\r\n            const config = { method, url: '/db' + url, headers: { 'Conn-Id': this.connId } };\r\n            if (method === 'get') config.params = data; else config.data = data;\r\n            return request(config);\r\n        },\r\n        getMapValue(obj, key) {\r\n            if (!obj) return null;\r\n            if (obj[key] !== undefined) return obj[key];\r\n            if (obj[key.toLowerCase()] !== undefined) return obj[key.toLowerCase()];\r\n            if (obj[key.toUpperCase()] !== undefined) return obj[key.toUpperCase()];\r\n            return null;\r\n        },\r\n        isOptionTrue(val) {\r\n            if (!val) return false;\r\n            const s = String(val).toUpperCase();\r\n            return s === 'YES' || s === 'Y' || s === 'TRUE' || s === '1';\r\n        },\r\n\r\n        // --- 全选逻辑 ---\r\n        handleSysGrantAllChange(val) {\r\n            this.sysPrivList.forEach(item => { item.granted = val; if (!val) item.admin = false; });\r\n            this.updateSysAdminHeaderState();\r\n        },\r\n        handleSysAdminAllChange(val) {\r\n            this.sysPrivList.forEach(item => { item.admin = val; if (val) item.granted = true; });\r\n            this.updateSysGrantHeaderState();\r\n        },\r\n        handleObjGrantAllChange(val) {\r\n            this.currentObjPerms.forEach(item => { item.granted = val; if (!val) item.admin = false; });\r\n            this.updateObjAdminHeaderState();\r\n        },\r\n        handleObjAdminAllChange(val) {\r\n            this.currentObjPerms.forEach(item => { item.admin = val; if (val) item.granted = true; });\r\n            this.updateObjGrantHeaderState();\r\n        },\r\n\r\n        // --- 行点击逻辑 ---\r\n        handleGrantChange(row) { if (!row.granted) row.admin = false; },\r\n        handleAdminChange(row) { if (row.admin) row.granted = true; },\r\n\r\n        handleSysRowChange(row, type) {\r\n            if (type === 'grant') this.handleGrantChange(row);\r\n            if (type === 'admin') this.handleAdminChange(row);\r\n            this.updateSysGrantHeaderState();\r\n            this.updateSysAdminHeaderState();\r\n        },\r\n        handleObjRowChange(row, type) {\r\n            if (type === 'grant') this.handleGrantChange(row);\r\n            if (type === 'admin') this.handleAdminChange(row);\r\n            this.updateObjGrantHeaderState();\r\n            this.updateObjAdminHeaderState();\r\n        },\r\n\r\n        updateSysGrantHeaderState() { this.sysGrantAll = this.sysPrivList.length > 0 && this.sysPrivList.every(i => i.granted); },\r\n        updateSysAdminHeaderState() { this.sysAdminAll = this.sysPrivList.length > 0 && this.sysPrivList.every(i => i.admin); },\r\n        updateObjGrantHeaderState() { this.objGrantAll = this.currentObjPerms.length > 0 && this.currentObjPerms.every(i => i.granted); },\r\n        updateObjAdminHeaderState() { this.objAdminAll = this.currentObjPerms.length > 0 && this.currentObjPerms.every(i => i.admin); },\r\n\r\n        // --- API 调用 ---\r\n        refreshData() { this.loading = true; this.initData().finally(() => { this.loading = false; }); },\r\n        async initData() {\r\n            try {\r\n                const sRes = await this.request('get', '/schemas');\r\n                this.schemaList = sRes.data.data || [];\r\n                if (this.schemaList.includes('DMDB')) this.selectedSchema = 'DMDB';\r\n                else if (this.schemaList.length) this.selectedSchema = this.schemaList[0];\r\n                await Promise.all([this.loadTables(), this.loadRoleInfo()]);\r\n            } catch (e) { this.$message.error(\"初始化失败: \" + e.message); }\r\n        },\r\n        async loadRoleInfo() {\r\n            const res = await this.request('get', '/role/detail', { roleName: this.roleName });\r\n            if (res.data.code === 200) {\r\n                const data = res.data.data;\r\n\r\n                const dbRoles = data.rolePrivs || [];\r\n                this.generalRoles.forEach(row => {\r\n                    const found = dbRoles.find(r => this.getMapValue(r, 'GRANTED_ROLE') === row.name);\r\n                    row.granted = !!found;\r\n                    row.admin = !!(found && this.isOptionTrue(this.getMapValue(found, 'ADMIN_OPTION')));\r\n                    row._orig = { granted: row.granted, admin: row.admin };\r\n                });\r\n\r\n                const dbSys = data.sysPrivs || [];\r\n                this.sysPrivList.forEach(row => {\r\n                    const found = dbSys.find(p => {\r\n                        const pName = this.getMapValue(p, 'PRIVILEGE');\r\n                        return pName && pName.trim().toUpperCase() === row.name.trim().toUpperCase();\r\n                    });\r\n                    row.granted = !!found;\r\n                    row.admin = !!(found && this.isOptionTrue(this.getMapValue(found, 'ADMIN_OPTION')));\r\n                    row._orig = { granted: row.granted, admin: row.admin };\r\n                });\r\n\r\n                this.existingObjPrivs = data.objPrivs || [];\r\n                this.$nextTick(() => { this.updateSysGrantHeaderState(); this.updateSysAdminHeaderState(); });\r\n            }\r\n        },\r\n        async loadTables() {\r\n            if (!this.selectedSchema) return;\r\n            const res = await this.request('get', '/tables', { schema: this.selectedSchema });\r\n            this.tableList = (res.data.data || []).map(t => t.TABLE_NAME);\r\n            this.currentTable = '';\r\n        },\r\n        handleTableSelect(tableName) {\r\n            this.currentTable = tableName;\r\n            this.currentObjPerms = OBJ_PRIVS.map(pName => {\r\n                const found = this.existingObjPrivs.find(p =>\r\n                    this.getMapValue(p, 'OWNER') === this.selectedSchema &&\r\n                    this.getMapValue(p, 'TABLE_NAME') === tableName &&\r\n                    this.getMapValue(p, 'PRIVILEGE').toUpperCase() === pName.toUpperCase()\r\n                );\r\n                return {\r\n                    name: pName,\r\n                    granted: !!found,\r\n                    admin: !!(found && this.isOptionTrue(this.getMapValue(found, 'GRANTABLE')))\r\n                };\r\n            });\r\n            this.$nextTick(() => { this.updateObjGrantHeaderState(); this.updateObjAdminHeaderState(); });\r\n        },\r\n        getChanges(list, keyName) {\r\n            const changes = [];\r\n            list.forEach(row => {\r\n                if (!row._orig && keyName !== 'priv') return;\r\n                const origGranted = row._orig ? row._orig.granted : false;\r\n                const origAdmin = row._orig ? row._orig.admin : false;\r\n                if (!origGranted && row.granted) changes.push({ [keyName]: row.name, action: 'GRANT', admin: row.admin });\r\n                else if (origGranted && !row.granted) changes.push({ [keyName]: row.name, action: 'REVOKE', admin: false });\r\n                else if (row.granted && row.admin !== origAdmin) changes.push({ [keyName]: row.name, action: 'GRANT', admin: row.admin });\r\n            });\r\n            return changes;\r\n        },\r\n        async saveGeneral() {\r\n            const changes = this.getChanges(this.generalRoles, 'role');\r\n            if (!changes.length) return this.$message.info(\"无变更\");\r\n            this.loading = true;\r\n            try { await this.request('post', '/role/role-privs', { roleName: this.roleName, changes }); this.$message.success(\"保存成功\"); await this.loadRoleInfo(); } catch (e) { this.$message.error(e.response?.data?.msg || \"保存失败\"); } finally { this.loading = false; }\r\n        },\r\n        async saveSysPrivs() {\r\n            const changes = this.getChanges(this.sysPrivList, 'priv');\r\n            if (!changes.length) return this.$message.info(\"无变更\");\r\n            this.loading = true;\r\n            try { await this.request('post', '/role/sys-privs', { roleName: this.roleName, changes }); this.$message.success(\"保存成功\"); await this.loadRoleInfo(); } catch (e) { this.$message.error(e.response?.data?.msg || \"保存失败\"); } finally { this.loading = false; }\r\n        },\r\n        async saveObjPrivs() {\r\n            if (!this.currentTable) return;\r\n            const changes = [];\r\n            this.currentObjPerms.forEach(row => {\r\n                const found = this.existingObjPrivs.find(p =>\r\n                    this.getMapValue(p, 'OWNER') === this.selectedSchema &&\r\n                    this.getMapValue(p, 'TABLE_NAME') === this.currentTable &&\r\n                    this.getMapValue(p, 'PRIVILEGE').toUpperCase() === row.name.toUpperCase()\r\n                );\r\n                const origGranted = !!found;\r\n                const origAdmin = !!(found && this.isOptionTrue(this.getMapValue(found, 'GRANTABLE')));\r\n                if (!origGranted && row.granted) changes.push({ priv: row.name, action: 'GRANT', admin: row.admin });\r\n                else if (origGranted && !row.granted) changes.push({ priv: row.name, action: 'REVOKE', admin: false });\r\n                else if (row.granted && row.admin !== origAdmin) changes.push({ priv: row.name, action: 'GRANT', admin: row.admin });\r\n            });\r\n            if (!changes.length) return this.$message.info(\"无变更\");\r\n            this.loading = true;\r\n            try { await this.request('post', '/role/obj-privs', { roleName: this.roleName, schema: this.selectedSchema, table: this.currentTable, changes }); this.$message.success(\"保存成功\"); await this.loadRoleInfo(); this.handleTableSelect(this.currentTable); } catch (e) { this.$message.error(e.response?.data?.msg || \"保存失败\"); } finally { this.loading = false; }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* 全局容器 */\r\n.role-manage-container {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    background-color: #fff;\r\n    border-radius: 4px;\r\n    overflow: hidden;\r\n}\r\n\r\n/* 1. Header 样式 */\r\n.main-header {\r\n    height: 60px;\r\n    padding: 0 20px;\r\n    border-bottom: 1px solid #ebeef5;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    background: #fff;\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);\r\n    z-index: 10;\r\n}\r\n\r\n.role-identity {\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\n.avatar-box {\r\n    width: 36px;\r\n    height: 36px;\r\n    border-radius: 50%;\r\n    background: #ecf5ff;\r\n    color: #409EFF;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    font-size: 18px;\r\n    margin-right: 12px;\r\n    border: 1px solid #d9ecff;\r\n}\r\n\r\n.info .label {\r\n    font-size: 12px;\r\n    color: #909399;\r\n    line-height: 1.2;\r\n}\r\n\r\n.info .value {\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n    color: #303133;\r\n}\r\n\r\n/* 2. Tabs 样式 */\r\n.main-content {\r\n    flex: 1;\r\n    overflow: hidden;\r\n    padding: 15px 20px;\r\n}\r\n\r\n.stylish-tabs {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    box-shadow: none !important;\r\n    border: 1px solid #ebeef5;\r\n}\r\n\r\n::v-deep .el-tabs__content {\r\n    flex: 1;\r\n    height: 0;\r\n    padding: 0;\r\n    overflow: hidden;\r\n}\r\n\r\n::v-deep .el-tab-pane {\r\n    height: 100%;\r\n}\r\n\r\n/* 通用面板布局 */\r\n.pane-layout {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 15px;\r\n}\r\n\r\n.pane-toolbar {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-bottom: 12px;\r\n    background-color: #fcfcfc;\r\n    border: 1px solid #ebeef5;\r\n    padding: 8px 12px;\r\n    border-radius: 4px;\r\n}\r\n\r\n.toolbar-left {\r\n    font-size: 13px;\r\n    color: #606266;\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\n.text-info {\r\n    color: #909399;\r\n    margin-right: 6px;\r\n    font-size: 16px;\r\n}\r\n\r\n.text-warning {\r\n    color: #E6A23C;\r\n    margin-right: 6px;\r\n    font-size: 16px;\r\n}\r\n\r\n.table-wrapper {\r\n    flex: 1;\r\n    overflow: hidden;\r\n    border: 1px solid #ebeef5;\r\n    border-radius: 2px;\r\n}\r\n\r\n/* 3. 对象权限 双栏布局 */\r\n.obj-layout {\r\n    height: 100%;\r\n    display: flex;\r\n}\r\n\r\n/* 左侧导航 */\r\n.obj-sidebar {\r\n    width: 260px;\r\n    border-right: 1px solid #ebeef5;\r\n    background-color: #fdfdfd;\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n.sidebar-search {\r\n    padding: 12px;\r\n    border-bottom: 1px solid #ebeef5;\r\n    background: #fff;\r\n}\r\n\r\n.schema-select {\r\n    width: 100%;\r\n    margin-bottom: 8px;\r\n}\r\n\r\n.sidebar-list {\r\n    flex: 1;\r\n    overflow-y: auto;\r\n    padding: 8px 0;\r\n}\r\n\r\n.nav-item {\r\n    padding: 10px 15px;\r\n    cursor: pointer;\r\n    font-size: 13px;\r\n    color: #606266;\r\n    display: flex;\r\n    align-items: center;\r\n    border-left: 3px solid transparent;\r\n    transition: all 0.2s;\r\n}\r\n\r\n.nav-item i {\r\n    margin-right: 8px;\r\n    color: #909399;\r\n}\r\n\r\n.nav-item:hover {\r\n    background-color: #f5f7fa;\r\n    color: #409EFF;\r\n}\r\n\r\n.nav-item:hover i {\r\n    color: #409EFF;\r\n}\r\n\r\n.nav-item.is-active {\r\n    background-color: #ecf5ff;\r\n    color: #409EFF;\r\n    border-left-color: #409EFF;\r\n    font-weight: 500;\r\n}\r\n\r\n.nav-item.is-active i {\r\n    color: #409EFF;\r\n}\r\n\r\n.empty-nav {\r\n    text-align: center;\r\n    color: #909399;\r\n    margin-top: 20px;\r\n    font-size: 12px;\r\n}\r\n\r\n/* 右侧详情 */\r\n.obj-detail {\r\n    flex: 1;\r\n    background: #fff;\r\n    overflow: hidden;\r\n}\r\n\r\n.detail-inner {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 15px;\r\n}\r\n\r\n.label {\r\n    font-size: 13px;\r\n    color: #909399;\r\n    margin-right: 8px;\r\n}\r\n\r\n.empty-state {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: #c0c4cc;\r\n}\r\n\r\n.empty-state i {\r\n    font-size: 48px;\r\n    margin-bottom: 10px;\r\n    color: #e4e7ed;\r\n}\r\n\r\n/* 统一的绿色 Tag 样式 */\r\n.priv-name-tag {\r\n    background-color: #f0f9eb;\r\n    border-color: #e1f3d8;\r\n    color: #67c23a;\r\n    font-weight: 500;\r\n    border-radius: 4px;\r\n}\r\n\r\n/* 复选框微调 */\r\n::v-deep .el-checkbox__inner {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n::v-deep .el-checkbox__inner::after {\r\n    left: 5px;\r\n    top: 2px;\r\n}\r\n\r\n/* 自定义滚动条 */\r\n.custom-scroll::-webkit-scrollbar {\r\n    width: 6px;\r\n}\r\n\r\n.custom-scroll::-webkit-scrollbar-thumb {\r\n    background: #dcdfe6;\r\n    border-radius: 3px;\r\n}\r\n\r\n.custom-scroll::-webkit-scrollbar-track {\r\n    background: transparent;\r\n}\r\n</style>"]}]}